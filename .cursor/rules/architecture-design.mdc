---
description: Technical architecture and solution proposal rules
globs: architecture/**/*.md, design/*.md, **/design.md
alwaysApply: false
---
# Architect Guidelines

## IDesign Method™ Compliance

All architecture documents must follow the IDesign Method™ principles:

1. **Service-Oriented Architecture**: Factor into independent services
2. **Closed Architecture Pattern**: Components only call down one tier
3. **Assembly Allocation**: Document which components go to which assemblies
4. **Process Allocation**: Document which services run in which processes
5. **Identity Boundaries**: Document identity management decisions
6. **Authentication/Authorization**: Mark boundaries with solid/patterned bars
7. **Transaction Boundaries**: Document transaction scopes

## Required Architecture Diagrams

1. **Static Architecture View**: Show logical services and components
2. **Call Chain Diagrams**: Show use case flows through architecture
3. **Assembly Allocation Diagram**: Box notation for assemblies
4. **Process Allocation Diagram**: Box notation for processes
5. **Identity Boundaries**: Box notation for identity scopes
6. **Authentication/Authorization Boundaries**: Solid/patterned bar notation
7. **Transaction Boundaries**: Box notation for transaction scopes

## Framework and Tools

- **Framework**: Use IDesign Method™ notations (boxes and bars) for run-time aspects
- **Visuals**: Use Mermaid.js for logic flows, ASCII/text for IDesign Method™ diagrams
- **Security**: Dedicate sections to:
  - Identity Management
  - Authentication boundaries (solid bar)
  - Authorization boundaries (patterned bar)
  - Data Sovereignty
  - Encryption at Rest/Transit
- **Trade-offs**: Include an "Alternatives Considered" section explaining why the chosen solution is optimal

## Service Boundaries

- Document all service boundaries explicitly
- Show which services can call which other services (closed architecture)
- Mark authentication and authorization at each boundary
- Document transaction flow across boundaries

## File Management Rules

CRITICAL: Follow these rules for all file operations:

1. Do not generate unnecessary files. Only create files that are explicitly requested or required for the task.
2. Do not delete and recreate whole files. Use search_replace or similar tools to make targeted edits to existing files.
3. Use one CHANGELOG.md file in the root directory. Do not create multiple changelog files or version-specific changelogs.
4. Use one PATCH-*.md file per set of required changes. This file will be deleted after changes are applied. Do not create multiple patch files for the same change set.
5. Always update documentation and global files after changes:
   - Update README.md if project structure or usage changes
   - Update docs/design.md if architecture changes
   - Update CHANGELOG.md with all changes
   - Update relevant documentation files
6. Do not use emojis, icons, or horizontal rules (---) in documentation files. Keep formatting clean and professional.
7. Keep documentation clean and concise. Remove unnecessary content, avoid redundancy, and focus on essential information.

## Documentation Location Rules

CRITICAL: Follow these rules for documentation placement:

1. **Global Project Documentation**: Place in `docs/` folder
   - Architecture documents (docs/ARCHITECTURE-*.md)
   - Product requirements (docs/PRD-*.md)
   - Data models (docs/DATA-*.md)
   - Engineering specs (docs/SPEC-*.md)
   - Solution proposals (docs/SOLUTION-*.md)
   - Technical documentation (docs/TECHNICAL-DOCUMENTATION.md)
   - System design (docs/design.md)
   - Code standards (docs/CODE-DOCUMENTATION-STANDARDS.md)
   - Developer guides (docs/DEVELOPER-QUICK-REFERENCE.md)
   - Compliance documents (docs/IDESIGN-CSHARP-CODING-STANDARD-COMPLIANCE.md)

2. **Source Code Specific Documentation**: Place in `src/` folder
   - Application-specific docs: `src/DocToolkit/Docs/` or `src/DocToolkit/README.md`
   - Test-specific docs: `src/tests/DocToolkit.Tests/README.md` or `src/tests/DocToolkit.Tests/Docs/`
   - Component-specific docs: Co-located with source code (e.g., `src/DocToolkit/Engines/README.md`)

3. **Root Level Documentation**: Only essential project files
   - README.md (project overview)
   - CHANGELOG.md (project changelog)
   - ONBOARDING.md (project onboarding)
   - LICENSE (if applicable)

4. **Do NOT create documentation in**:
   - Multiple locations for the same content
   - Temporary or intermediary folders
   - Root directory (except essential files listed above)